var t={btnControl:document.querySelector(".control-btn"),form:document.querySelectorAll("form[data-control]"),bookEl:document.querySelector("div.books")};const{form:e}=t,[o,r]=e;var n=function(t){switch(t.target.classList.value){case"add":o.classList.add("show"),r.classList.remove("show");break;case"update":o.classList.remove("show"),r.classList.add("show");break;case"hide":o.classList.remove("show"),r.classList.remove("show")}};const a=(t,e={})=>({method:t,body:JSON.stringify(e),headers:{"content-type":"application/json",charset:"UTF-8"}});var s=async function(){const t=await fetch("http://localhost:3000/books");if(!t.ok)throw new Error(t.Error);return t.json()};var i=function(t){return t.map((({id:t,name:e,rating:o,describe:r})=>`\n<div class="books__item" data-id=${t}>\n<div class="books__name"><span>name:</span>${e}</div>\n<div class="books__rating"><span>rating:</span>${o}</div>\n<div class="books__describe">\n${r}\n</div>\n<button class="delete">delete</button>\n</div>\n`)).join("")};var c=function(){s().then((e=>{t.bookEl.replaceChildren(),t.bookEl.insertAdjacentHTML("beforeend",i(e))}))};var l=function(t){t.preventDefault();const e={},o=new FormData(t.currentTarget);for(let[t,r]of o){if(!r)return void alert(`Not: ${t}`);e[t]=r}var r;/^(10|[1-9])$/.test(e.rating)?(r=a("POST",e),fetch("http://localhost:3000/books",r).then((t=>{if(!t.ok)throw new Error(t.Error);return t.json()})).then(c),t.currentTarget.reset()):alert("Wrong rating! Enter from 1 to 10")};var d=function(t){t.preventDefault();const{name:{value:e},rating:{value:o},describe:{value:r}}=t.currentTarget.elements;var n;(n=e,s().then((t=>t.find((({name:t})=>t.toLowerCase()===n.toLowerCase()))))).then((e=>{var n,s;e?/^(10|[1-9])$/.test(o)?((n=e.id,s=a("PATCH",{rating:o,describe:r}),fetch(`http://localhost:3000/books/${n}`,s).then((t=>{if(!t.ok)throw new Error(t.Error);return t.json()}))).then(c),t.target.reset()):alert("Rating is incorrect (1-10)"):alert("Book not found")}))};var v=function(t){if(!t.target.classList.contains("delete"))return;const e=t.target.parentElement.dataset.id;var o,r;o=e,r=a("DELETE"),fetch(`http://localhost:3000/books/${o}`,r).then(c)};c();const{btnControl:h,form:u,bookEl:f}=t,[b,m]=u;h.addEventListener("click",n),b.addEventListener("submit",l),m.addEventListener("submit",d),f.addEventListener("click",v);
//# sourceMappingURL=index.a21bc2c4.js.map
